<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Browse Songs</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <!-- Hamburger Menu -->
  <button id="menu-toggle" aria-label="Toggle menu">&#9776;</button>

  <!-- Sidebar (Loaded from external file) -->
  <div id="sidebar-container"></div>

  <script>
    fetch('sidebar.html')
      .then(response => response.text())
      .then(html => {
        document.getElementById('sidebar-container').innerHTML = html;

        // Sidebar Toggle
        const menuToggle = document.getElementById("menu-toggle");
        const sidebar = document.getElementById("sidebar");
        menuToggle.addEventListener("click", () => {
          sidebar.classList.toggle("open");
        });

        // Page Transitions
        const navLinks = sidebar.querySelectorAll("a");
        navLinks.forEach(link => {
          link.addEventListener("click", (e) => {
            e.preventDefault();
            const mainContent = document.getElementById("main-content");
            mainContent.classList.add("fade-out");
            setTimeout(() => {
              window.location.href = link.href;
            }, 500);
          });
        });
      });

    document.addEventListener("DOMContentLoaded", () => {
      document.getElementById("main-content").classList.add("fade-in");
    });
  </script>

  <!-- Main Content -->
  <div id="main-content">
    <div id="songs-wrapper">
      <button id="play-all-btn">Play All</button>
      <div id="songs-container">

            <div class="song" onclick="addToQueueAndPlay('songs/blackstreet_cover.wav', 'Blackstreet Cover')" data-src="songs/blackstreet_cover.wav">
              <h2>Blackstreet Cover <span class="song-time">(0:45)</span></h2>
              <button class="download-btn" onclick="event.stopPropagation(); downloadSong('songs/blackstreet_cover.wav')">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                  <polyline points="7 10 12 15 17 10"></polyline>
                  <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
              </button>
               <button class="add-to-queue-btn" onclick="event.stopPropagation(); addToQueue('songs/blackstreet_cover.wav', 'Blackstreet Cover')">+</button>
            </div>
            

            <div class="song" onclick="addToQueueAndPlay('songs/discovery.wav', 'Discovery')" data-src="songs/discovery.wav">
              <h2>Discovery <span class="song-time">(0:41)</span></h2>
              <button class="download-btn" onclick="event.stopPropagation(); downloadSong('songs/discovery.wav')">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                  <polyline points="7 10 12 15 17 10"></polyline>
                  <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
              </button>
               <button class="add-to-queue-btn" onclick="event.stopPropagation(); addToQueue('songs/discovery.wav', 'Discovery')">+</button>
            </div>
            

            <div class="song" onclick="addToQueueAndPlay('songs/final_boss.wav', 'Final Boss')" data-src="songs/final_boss.wav">
              <h2>Final Boss <span class="song-time">(1:06)</span></h2>
              <button class="download-btn" onclick="event.stopPropagation(); downloadSong('songs/final_boss.wav')">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                  <polyline points="7 10 12 15 17 10" />
                  <line x1="12" x2="12" y1="15" y2="3" />
                </svg>
              </button>
               <button class="add-to-queue-btn" onclick="event.stopPropagation(); addToQueue('songs/final_boss.wav', 'Final Boss')">+</button>
            </div>
            

            <div class="song" onclick="addToQueueAndPlay('songs/galaxy_wars.wav', 'Galaxy Wars')" data-src="songs/galaxy_wars.wav">
              <h2>Galaxy Wars <span class="song-time">(0:46)</span></h2>
              <button class="download-btn" onclick="event.stopPropagation(); downloadSong('songs/galaxy_wars.wav')">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                  <polyline points="7 10 12 15 17 10"></polyline>
                  <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
              </button>
               <button class="add-to-queue-btn" onclick="event.stopPropagation(); addToQueue('songs/galaxy_wars.wav', 'Galaxy Wars')">+</button>
            </div>
            

            <div class="song" onclick="addToQueueAndPlay('songs/journals.wav', 'Journals')" data-src="songs/journals.wav">
              <h2>Journals <span class="song-time">(0:39)</span></h2>
              <button class="download-btn" onclick="event.stopPropagation(); downloadSong('songs/journals.wav')">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                  <polyline points="7 10 12 15 17 10"></polyline>
                  <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
              </button>
               <button class="add-to-queue-btn" onclick="event.stopPropagation(); addToQueue('songs/journals.wav', 'Journals')">+</button>
            </div>
            

            <div class="song" onclick="addToQueueAndPlay('songs/make_you_feel_my_love_cover.wav', 'Make You Feel My Love Cover')" data-src="songs/make_you_feel_my_love_cover.wav">
              <h2>Make You Feel My Love Cover <span class="song-time">(1:06)</span></h2>
              <button class="download-btn" onclick="event.stopPropagation(); downloadSong('songs/make_you_feel_my_love_cover.wav')">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                  <polyline points="7 10 12 15 17 10"></polyline>
                  <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
              </button>
               <button class="add-to-queue-btn" onclick="event.stopPropagation(); addToQueue('songs/make_you_feel_my_love_cover.wav', 'Make You Feel My Love Cover')">+</button>
            </div>
            

            <div class="song" onclick="addToQueueAndPlay('songs/outliers.wav', 'Outliers')" data-src="songs/outliers.wav">
              <h2>Outliers <span class="song-time">(0:24)</span></h2>
              <button class="download-btn" onclick="event.stopPropagation(); downloadSong('songs/outliers.wav')">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                  <polyline points="7 10 12 15 17 10"></polyline>
                  <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
              </button>
               <button class="add-to-queue-btn" onclick="event.stopPropagation(); addToQueue('songs/outliers.wav', 'Outliers')">+</button>
            </div>
            

            <div class="song" onclick="addToQueueAndPlay('songs/outta_control.wav', 'Outta Control')" data-src="songs/outta_control.wav">
              <h2>Outta Control <span class="song-time">(1:49)</span></h2>
              <button class="download-btn" onclick="event.stopPropagation(); downloadSong('songs/outta_control.wav')">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                  <polyline points="7 10 12 15 17 10"></polyline>
                  <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
              </button>
               <button class="add-to-queue-btn" onclick="event.stopPropagation(); addToQueue('songs/outta_control.wav', 'Outta Control')">+</button>
            </div>
            

            <div class="song" onclick="addToQueueAndPlay('songs/spine_guidance.wav', 'Spine Guidance')" data-src="songs/spine_guidance.wav">
              <h2>Spine Guidance <span class="song-time">(1:46)</span></h2>
              <button class="download-btn" onclick="event.stopPropagation(); downloadSong('songs/spine_guidance.wav')">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                  <polyline points="7 10 12 15 17 10"></polyline>
                  <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
              </button>
               <button class="add-to-queue-btn" onclick="event.stopPropagation(); addToQueue('songs/spine_guidance.wav', 'Spine Guidance')">+</button>
            </div>
            

            <div class="song" onclick="addToQueueAndPlay('songs/supportive.wav', 'Supportive')" data-src="songs/supportive.wav">
              <h2>Supportive <span class="song-time">(0:24)</span></h2>
              <button class="download-btn" onclick="event.stopPropagation(); downloadSong('songs/supportive.wav')">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                  <polyline points="7 10 12 15 17 10"></polyline>
                  <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
              </button>
               <button class="add-to-queue-btn" onclick="event.stopPropagation(); addToQueue('songs/supportive.wav', 'Supportive')">+</button>
            </div>
            

            <div class="song" onclick="addToQueueAndPlay('songs/wicked_wild.wav', 'Wicked Wild')" data-src="songs/wicked_wild.wav">
              <h2>Wicked Wild <span class="song-time">(0:37)</span></h2>
              <button class="download-btn" onclick="event.stopPropagation(); downloadSong('songs/wicked_wild.wav')">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                  <polyline points="7 10 12 15 17 10"></polyline>
                  <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
              </button>
               <button class="add-to-queue-btn" onclick="event.stopPropagation(); addToQueue('songs/wicked_wild.wav', 'Wicked Wild')">+</button>
            </div>
            
  </div>
  </div>

  <!-- Queue Display -->
  <div id="queue-container">
    <div id="queue-header">
        Up Next <span id="queue-toggle">▼</span>
    </div>
    <div id="queue-content">
        <ul id="queue-list"></ul>
    </div>
  </div>

  <!-- Fixed Audio Player -->
  <div id="audio-player">
    <p id="current-song-title">Select a song to play</p>
    <audio id="player" controls>
      <source id="audio-source" src="" type="audio/wav">
      Your browser does not support the audio element.
    </audio>
    <button id="skip-btn" onclick="skipSong()">⏭️ Skip</button>
    <button id="loop-btn" onclick="toggleLoop()">🔁 Loop: Off</button>
    <button id="shuffle-btn" onclick="toggleShuffle()">🔀 Shuffle: Off</button>
  </div>

  <script>
    let queue = [];
    let currentSongIndex = -1;
    let loopMode = false;
    let shuffleMode = false;

    const audioPlayer = document.getElementById("player");
    const audioSource = document.getElementById("audio-source");
    const currentSongTitle = document.getElementById("current-song-title");
    const queueList = document.getElementById("queue-list");
    const loopBtn = document.getElementById("loop-btn");
    const shuffleBtn = document.getElementById("shuffle-btn");

    function addToQueue(songPath, songTitle, playImmediately = false) {
      // Add song to queue
      queue.push({ path: songPath, title: songTitle });
      updateQueueDisplay();

      // If we want to play immediately, start playing it
      if (playImmediately) {
          playSongAtIndex(queue.length - 1);  // Play the newly added song
      }
    }

    function addToQueueAndPlay(songPath, songTitle) {
      // Clear queue and add only this song
      queue = [{ path: songPath, title: songTitle }];
      currentSongIndex = 0;
      
      updateQueueDisplay();
      playSongAtIndex(0);
    }

    function moveToTopOfQueue(songPath, songTitle) {
      // Move the song to the top of the queue
      const songIndex = queue.findIndex(song => song.path === songPath);
      if (songIndex !== -1) {
          // Remove the song and add it to the top
          const song = queue.splice(songIndex, 1)[0];
          queue.unshift(song);
      } else {
          // If not in the queue, add it to the top
          addToQueue(songPath, songTitle);
      }
      
      updateQueueDisplay();
      playNextSong(); // Start playing immediately
    }

    function removeCurrentSongFromQueue() {
      if (currentSongIndex !== -1) {
        queue.splice(currentSongIndex, 1);
        updateQueueDisplay();
      }
    }

    function updateQueueDisplay() {
      queueList.innerHTML = "";
      queue.forEach((song, index) => {
          let li = document.createElement("li");
          li.textContent = song.title;
          li.onclick = () => playSongAtIndex(index);
          if (index === currentSongIndex) {
              li.style.fontWeight = "bold";
          }
          queueList.appendChild(li);
      });
    }

    function playNextSong() {
        if (queue.length === 0) return;
        currentSongIndex = shuffleMode ? Math.floor(Math.random() * queue.length) : 0;
        playSongAtIndex(currentSongIndex);
    }

  function playSongAtIndex(index) {
      if (index >= queue.length) return;

      currentSongIndex = index;

      // Set audio source
      audioSource.src = queue[index].path;
      currentSongTitle.textContent = queue[index].title;

      // Force play
      audioPlayer.load();  
      audioPlayer.play()
          .then(() => console.log("Playing: " + queue[index].title))
          .catch(error => console.error("Playback error:", error));
  }

    function skipSong() {
        if (loopMode) {
            playSongAtIndex(currentSongIndex);
        } else if (shuffleMode) {
            currentSongIndex = Math.floor(Math.random() * queue.length);
            playSongAtIndex(currentSongIndex);
        } else if (currentSongIndex + 1 < queue.length) {
            removeCurrentSongFromQueue();
            playSongAtIndex(currentSongIndex + 1);
        } else {
            queue = [];
            currentSongIndex = -1;
            updateQueueDisplay();
            currentSongTitle.textContent = "Select a song to play";
            audioSource.src = "";
            audioPlayer.pause();
        }
    }

    audioPlayer.addEventListener("ended", () => {
        if (loopMode) {
            playSongAtIndex(currentSongIndex);
        } else {
            removeCurrentSongFromQueue();
            playNextSong();
        }
    });

    function toggleLoop() {
        loopMode = !loopMode;
        loopBtn.textContent = loopMode ? "🔁 Loop: On" : "🔁 Loop: Off";
    }

    function toggleShuffle() {
        shuffleMode = !shuffleMode;
        shuffleBtn.textContent = shuffleMode ? "🔀 Shuffle: On" : "🔀 Shuffle: Off";
    }

    function downloadSong(songPath) {
        const a = document.createElement("a");
        a.href = songPath;
        a.download = songPath.split('/').pop();
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
    }
  </script>

  <script src="version.js"></script>
  <script>
      // Once the page loads, display the version number
      window.onload = function() {
          const versionDiv = document.createElement('div');
          versionDiv.id = 'version';
          versionDiv.textContent = 'Version ' + VERSION;
          document.body.appendChild(versionDiv);
      };
  </script>

  <script src="script.js"></script>
  </body>
  </html>

</body>
</html>
