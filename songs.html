<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Browse Songs</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Hamburger Menu -->
  <button id="menu-toggle" aria-label="Toggle menu">&#9776;</button>

  <!-- Sidebar (Loaded from external file) -->
  <div id="sidebar-container"></div>

  <script>
    // Load the sidebar into the #sidebar-container
    fetch('sidebar.html')
      .then(response => response.text())
      .then(html => {
        document.getElementById('sidebar-container').innerHTML = html;

        // Re-attach toggle functionality after loading
        const menuToggle = document.getElementById("menu-toggle");
        const sidebar = document.getElementById("sidebar");
        menuToggle.addEventListener("click", () => {
          sidebar.classList.toggle("open");
        });

        // Attach page transition functionality to navigation links only
        const navLinks = sidebar.querySelectorAll("a");
        navLinks.forEach(link => {
          link.addEventListener("click", (e) => {
            e.preventDefault();
            const mainContent = document.getElementById("main-content");
            mainContent.classList.add("fade-out");
            setTimeout(() => {
              window.location.href = link.href;
            }, 500);
          });
        });
      });

    document.addEventListener("DOMContentLoaded", () => {
      document.getElementById("main-content").classList.add("fade-in");
    });
  </script>

  <!-- Main Content -->
  <div id="main-content">
    <h1>My Songs</h1>
    <div id="songs-container">
      <div class="song" data-src="songs/supportive.wav">
        <h2>Supportive <span class="song-time">(3:25)</span></h2>
        <button class="download-btn" onclick="downloadSong('songs/supportive.wav')">⬇</button>
      </div>
      <div class="song" data-src="songs/make_you_feel_my_love.wav">
        <h2>Make You Feel My Love <span class="song-time">(4:10)</span></h2>
        <button class="download-btn" onclick="downloadSong('songs/make_you_feel_my_love.wav')">⬇</button>
      </div>
      <div class="song" data-src="songs/journals.wav">
        <h2>Journals <span class="song-time">(2:47)</span></h2>
        <button class="download-btn" onclick="downloadSong('songs/journals.wav')">⬇</button>
      </div>
      <div class="song" data-src="songs/outliers.wav">
        <h2>Outliers <span class="song-time">(3:58)</span></h2>
        <button class="download-btn" onclick="downloadSong('songs/outliers.wav')">⬇</button>
      </div>
    </div>
  </div>

  <!-- Fixed Audio Player at the Bottom -->
  <div id="audio-player">
    <p id="current-song-title">Select a song to play</p>
    <audio id="player" controls>
      <source id="audio-source" src="" type="audio/wav">
      Your browser does not support the audio element.
    </audio>
  </div>

  <script>
    // Song selection and audio player handling
    document.addEventListener("DOMContentLoaded", () => {
      const songs = document.querySelectorAll(".song");
      const audioPlayer = document.getElementById("player");
      const audioSource = document.getElementById("audio-source");
      const songTitle = document.getElementById("current-song-title");

      songs.forEach(song => {
        song.addEventListener("click", () => {
          const songSrc = song.getAttribute("data-src");
          const title = song.querySelector("h2").textContent;
          
          audioSource.src = songSrc;
          audioPlayer.load();
          audioPlayer.play();
          songTitle.textContent = `Now Playing: ${title}`;
        });
      });
    });

    // Function to download song
    function downloadSong(songUrl) {
      const link = document.createElement('a');
      link.href = songUrl;
      link.download = songUrl.split('/').pop(); // Extract filename
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }
  </script>

  <script src="version.js"></script>
</body>
</html>
